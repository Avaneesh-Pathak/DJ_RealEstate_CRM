{% extends 'base.html' %}

{% block content %}
<style>
    /* General styling */
    body {
        background-color: #87CEEB; /* Light background */
        font-family: 'Open Sans', sans-serif; /* Font family */
    }

    .container {
        background-color: #ffffff; /* White background for the form */
        border-radius: 10px; /* Rounded corners */
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1); /* Subtle shadow effect */
        padding: 20px; /* Padding inside the container */
        box-shadow: 0 0 100px rgba(0, 0, 0, 0.1);
    }

    h2 {
        color: #007bff; /* Primary color for headings */
        margin-bottom: 20px; /* Space below heading */
    }

    h4 {
        color: #343a40; /* Darker color for subheadings */
        margin-top: 20px; /* Space above subheadings */
        margin-bottom: 10px; /* Space below subheadings */
    }

    .form-group {
        margin-bottom: 15px; /* Space between form groups */
    }

    .col-form-label {
        font-weight: bold; /* Bold labels */
    }
    input[type="text"],
    input[type="email"],
    input[type="number"],
    textarea {
            padding: 5px;
            border: 2px solid #ccc;
            border-radius: 5px;
            font-size: 14px;
            width: 100%;
            box-sizing: border-box; /* Ensure padding doesn't affect overall width */
    }

    .form-control {
        border: 2px solid #007bff !important; /* Change the border color and thickness */
        border-radius: 5px; /* Rounded corners */
        padding: 10px; /* Padding inside the inputs */
        font-size: 16px; /* Larger font size for better readability */
        transition: border-color 0.3s; /* Smooth transition for border color */
    }

    .form-control:focus {
        border-color: #0056b3; /* Change border color on focus */
        box-shadow: 0 0 5px rgba(0, 123, 255, 0.5); /* Add shadow on focus */
    } 

    .btn-primary {
        background-color: #007bff; /* Primary button color */
        border-color: #007bff; /* Border color for button */
        font-weight: bold; /* Bold text for button */
    }

    .btn-primary:hover {
        background-color: #0056b3; /* Darker blue on hover */
        border-color: #0056b3; /* Darker border on hover */
    }

    .form-horizontal .col-form-label {
        text-align: left; /* Align labels to the left */
    }

    .text-center {
        text-align: center; /* Center text */
    }

    /* Custom styles for specific elements */
    #emi-options {
        background-color: #e9ecef; /* Light background for EMI details */
        border-radius: 5px; /* Rounded corners */
        padding: 15px; /* Padding around EMI details */
        margin-top: 20px; /* Space above EMI details */
    }

    /* Responsive design */
    @media (max-width: 768px) {
        .form-horizontal .col-form-label {
            text-align: left; /* Align labels to the left on smaller screens */
        }

        .form-group {
            margin-bottom: 50px; /* Reduce space between form groups on smaller screens */
        }
    }
</style>

<div class="container mt-5 mb-5 p-4">
    <h1 class="text-4xl text-gray-800 text-center my-5">PLOT REGISTRATION</h1>
    
    
    <form method="POST" class="form-horizontal">
        {% csrf_token %}
        
        <!-- Booking Date -->
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.booking_date.label }}</label>
            <div class="col-sm-10">
                {{ form.booking_date }}
            </div>
        </div>

        <!-- Personal Information -->
        <h3 class="text-2xl text-gray-800 text-center my-5">PERSONAL INFORMATION</h3>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.name.label }}</label>
            <div class="col-sm-10">
                {{ form.name }}
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label"></label>
            <div class="col-sm-10">
                <p><strong>Father's /Husband Name:</strong> {{ form.father_husband_name }}</p>
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.gender.label }}</label>
            <div class="col-sm-10">
                {{ form.gender }}
            </div>
        </div>
        <div class="form-group row" id="custom-gender-field" style="display:none;">
            <label class="col-sm-2 col-form-label">{{ form.custom_gender.label }}</label>
            <div class="col-sm-10">
                {{ form.custom_gender }}
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.dob.label }}</label>
            <div class="col-sm-10">
                {{ form.dob }}
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.mobile_no.label }}</label>
            <div class="col-sm-10">
                {{ form.mobile_no }}
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.address.label }}</label>
            <div class="col-sm-10">
                {{ form.address }}
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.bank_name.label }}</label>
            <div class="col-sm-10">
                {{ form.bank_name }}
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.account_no.label }}</label>
            <div class="col-sm-10">
                {{ form.account_no }}
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.email.label }}</label>
            <div class="col-sm-10">
                {{ form.email }}
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.nominee_name.label }}</label>
            <div class="col-sm-10">
                {{ form.nominee_name }}
            </div>
        </div>

        <!-- PLC Charges -->
        <h3 class="text-2xl text-gray-800 text-center my-5">BUISNESS INFORMATION</h3>
        <h4 class="text-gray-800">PLC Charges</h4>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.corner_plot_10.label }}</label>
            <div class="col-sm-10">
                {{ form.corner_plot_10 }}
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.corner_plot_5.label }}</label>
            <div class="col-sm-10">
                {{ form.corner_plot_5 }}
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.full_pay_discount.label }}</label>
            <div class="col-sm-10">
                {{ form.full_pay_discount }}
            </div>
        </div>

        <!-- Booking Details -->
        <h4 class='text-2xl text-gray-800 text-center my-5'>Booking Details</h4>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.location.label }}</label>
            <div class="col-sm-10">
                {{ form.location }}
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.project.label }}</label>
            <div class="col-sm-10">
                {{ form.project }}
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.associate_detail.label }}</label>
            <div class="col-sm-10">
                {{ form.associate_detail }}
            </div>
        </div>
        <div class="form-group row" id="promoter-field" style="display:none;">
            <label class="col-sm-2 col-form-label">{{ form.promoter.label }}</label>
            <div class="col-sm-10">
                {{ form.promoter }}
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.Plot_price.label }}</label>
            <div class="col-sm-10">
                {{ form.Plot_price }}
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.payment_type.label }}</label>
            <div class="col-sm-10">
                {{ form.payment_type }}
            </div>
        </div>

        <!-- EMI Options -->
        <div id="emi-options" style="display:none;">
            <h4>EMI Details</h4>
            <div class="form-group row">
                <label class="col-sm-2 col-form-label">{{ form.emi_tenure.label }}</label>
                <div class="col-sm-10">
                    {{ form.emi_tenure }}
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-2 col-form-label">{{ form.interest_rate.label }}</label>
                <div class="col-sm-10">
                    {{ form.interest_rate }}
                </div>
            </div>
            <div class="form-group row">
                <label class="col-sm-2 col-form-label">Calculated EMI:</label>
                <div class="col-sm-10">
                    <input type="text" id="calculated-emi" readonly class="form-control">
                </div>
            </div>
        </div>

        <!-- Payment Information -->
        <h4 class='text-2xl text-gray-800 text-center my-5'>Payment Information</h4>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.booking_amount.label }}</label>
            <div class="col-sm-10">
                {{ form.booking_amount }}
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.mode_of_payment.label }}</label>
            <div class="col-sm-10">
                {{ form.mode_of_payment }}
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.payment_date.label }}</label>
            <div class="col-sm-10">
                {{ form.payment_date }}
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">{{ form.remark.label }}</label>
            <div class="col-sm-10">
                {{ form.remark }}
            </div>
        </div>

        <!-- Submit Button -->
        <div class="form-group text-center mt-4">
            <button type="submit" class="btn btn-primary">Submit</button>
        </div>
    </form>
</div>

<!-- JavaScript -->
<script>
    // Show custom gender field if 'Other' is selected
    document.getElementById("id_gender").addEventListener("change", function() {
        const customGenderField = document.getElementById("custom-gender-field");
        customGenderField.style.display = this.value === "other" ? "block" : "none";
    });

    // Show promoter field if 'Associate Detail' is checked
    document.getElementById("id_associate_detail").addEventListener("change", function() {
        const promoterField = document.getElementById("promoter-field");
        promoterField.style.display = this.checked ? "block" : "none";
    });

    // Show EMI options if 'Installment' is selected for payment type
    document.getElementById("id_payment_type").addEventListener("change", function() {
        const emiOptions = document.getElementById("emi-options");
        emiOptions.style.display = this.value === "installment" ? "block" : "none";
    });

    // Calculate EMI dynamically
    function calculateEMI() {
        const plotPrice = parseFloat(document.getElementById("id_Plot_price").value) || 0; // Replace with the actual plot price if dynamic
        const downPayment = parseFloat(document.getElementById("id_booking_amount").value) || 0; // Ensure it's a number
        const emiTenure = parseInt(document.getElementById("id_emi_tenure").value) || 0; // Ensure it's a number
        const interestRate = parseFloat(document.getElementById("id_interest_rate").value) || 0; // Ensure it's a number
    
        // Calculate remaining amount after down payment
        const remainingAmount = plotPrice - downPayment;
    
        if (remainingAmount > 0 && emiTenure > 0 && interestRate > 0) {
            const monthlyInterestRate = interestRate / 100 / 12;
            const emi = remainingAmount * (monthlyInterestRate * Math.pow((1 + monthlyInterestRate), emiTenure)) / (Math.pow((1 + monthlyInterestRate), emiTenure) - 1);
            document.getElementById("calculated-emi").value = emi.toFixed(2);
        }
    }
    
    document.getElementById("id_emi_tenure").addEventListener("input", calculateEMI);
    document.getElementById("id_interest_rate").addEventListener("input", calculateEMI);
</script>

{% endblock %}
